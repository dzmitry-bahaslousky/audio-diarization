# Hugging Face Authentication (Required for WhisperX diarization)
# Get your token from: https://huggingface.co/settings/tokens
# Must accept model conditions at: https://huggingface.co/pyannote/speaker-diarization-3.1
HF_TOKEN=your_huggingface_token_here

# PyTorch 2.6+ Compatibility (Required for pyannote models)
# PyTorch 2.6 changed weights_only default to True, breaking pyannote model loading
# This environment variable reverts to the old behavior (safe for HuggingFace models)
TORCH_FORCE_WEIGHTS_ONLY_LOAD=0

# Whisper Configuration
WHISPER_MODEL=medium  # Options: tiny, base, small, medium, large, large-v2, large-v3, turbo
WHISPER_DEVICE=cpu    # Options: cpu, cuda (IMPORTANT: MPS not supported by faster-whisper/ctranslate2)

# WhisperX Performance Settings
WHISPERX_COMPUTE_TYPE=int8  # Options: int8 (CPU, recommended), float16 (CUDA only), float32 (CPU)
WHISPERX_BATCH_SIZE=16  # Batch size for inference (1-32, higher=faster but more memory)
WHISPERX_ENABLE_ALIGNMENT=true  # Enable word-level timestamps via wav2vec2
WHISPERX_ENABLE_DIARIZATION=true  # Enable speaker identification

# WhisperX Diarization Settings (Optional)
# WHISPERX_MIN_SPEAKERS=1  # Minimum expected speakers (optional hint)
# WHISPERX_MAX_SPEAKERS=10  # Maximum expected speakers (optional hint)

# Processing Timeout Settings (in seconds)
# Increase these for long-running audio files
TRANSCRIPTION_TIMEOUT=3600  # Transcription timeout (default: 60 minutes, max: 120 minutes)
ALIGNMENT_TIMEOUT=1200  # Alignment timeout (default: 20 minutes, max: 60 minutes)
DIARIZATION_TIMEOUT=3600  # Diarization timeout (default: 30 minutes, max: 120 minutes)

# Application Settings
MAX_UPLOAD_SIZE_MB=500
ALLOWED_EXTENSIONS=mp3,wav,m4a,flac,ogg,wma
TEMP_UPLOAD_DIR=./uploads
OUTPUT_DIR=./outputs

# API Configuration
API_HOST=0.0.0.0
API_PORT=8000
API_RELOAD=true  # Set to false in production

# Logging
LOG_LEVEL=INFO  # Options: DEBUG, INFO, WARNING, ERROR, CRITICAL

# Database (Phase 5)
DATABASE_URL=postgresql+psycopg://postgres:postgres@localhost:5432/audio_diarization

# Celery / Redis (Phase 5)
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0
CELERY_WORKER_CONCURRENCY=2  # Number of concurrent tasks (1=sequential, 2=default, 4+=parallel)

# Celery Task Timeouts (in seconds)
# For long audio files (2+ hours), increase these limits
# Diarization can take 2-4x the audio duration on CPU
CELERY_TASK_TIME_LIMIT=14400  # Hard limit: 4 hours (task killed after this)
CELERY_TASK_SOFT_TIME_LIMIT=12600  # Soft limit: 3.5 hours (warning raised, allows cleanup)
